# 2.5.1 - Create Full Book Record

Note: Pseudocode and variable/function names are only for guidance. The only things that are a must 
are the inputs and outputs of the functions.

Note: Creation of notes will be a separate function.

Note: Pretty much every function returns the values as JSON, this is for consistency for API accessing
These functions will need to either use existing, reworked, or new functions to construct.
The following functions are needed:
- ddd

### 2.5.1.1 - Create Full Book Record from JSON (subfunctions will plug into here)
Input JSON:
```JSON
{"ISBN": "user_provided_isbn",
 "title": "SomeBook",
 "publish_date": "2026",
 "summary": "asdfdasadfsdfsafds",
 "chapters": "23",
 "chapters_completed": "3",
 "cover_image_bytes": "",
 "Author_First_Name_1": "John",
 "Author_Last_Name_1": "Doe",
 "Author_First_Name_2": "Jane",
 "Author_Last_Name_3": "Doe",
 "Publisher_Name": "SomePublisher",
 "Owned": "yes",
 "Favorite": "yes",
 "Completed": "no",
 "Currently_Reading": "yes",
 "PersonalOrAcademic": "personal",
 "GenreID_1": "1",
 "Genre_1": "fiction",
 "GenreID_2": "3",
 "Genre_2": "fantasy",
 "GenreID_3": "6",
 "Genre_3": "humor",
 "GenreID_4": "4",
 "Genre_4": "drama"}
```

````
create_book_record(json):
    # Note: Gets all values from JSON
    # Note: all required values have been validate by mediator at this point
    # Note: all variables that use get() method have a default value of '', since they are optional for creation
    
    isbn = json['ISBN']
    
    # First make sure ISBN not present in Book Table
    is_isbn_present = is_isbn_in_book_table(isbn) -> JSON
    print(is_isbn_present) # Should return for example: {"is_isbn_present": "False"}
    TRY:
        IF is_isbn_present['is_isbn_present'] != False:
            return "Error: Book with ISBN present.", 400
    EXCEPT:
        raise ERROR "Status Code 500"
    
    title = json['title']
    author_first_name_1 = json['Author_First_Name_1']
    author_last_name_1 = json['Author_Last_Name_1']
    author_first_name_2 = json.get('Author_First_Name_2', '')
    author_last_name_2 = json.get('Author_Last_Name_2', '')
    publish_date = json['publish_date']
    publisher_name = json['Publisher_Name']
    summary = json.get('summary', '')
    chapters = json.get('chapters', '')
    chapters_completed = json.get('chapters_completed', '')
    owned = json['Owned']
    favorite = json['Favorite']
    completed = json['Completed']
    currently_reading = json['Currently_Reading']
    personal_or_academic = json['PersonalOrAcademic']
    genre_1 = json['Genre_1']
    genre_2 = json.get('Genre_2', '')
    genre_3 = json.get('Genre_3', '')
    genre_4 = json.get('Genre_4', '')
    cover_image_bytes = json.get('cover_image_bytes', '')             
        
    # Next create the new tag record and return the new tag_id
    tag_response = create_tag(owned, favorite, completed, currently_reading, personal_or_academic) -> JSON(tag_id)
    print(tag_response) # Should return for example: {"tag_id": "2"}
                  # Example tag_id 2
    TRY:
        IF tag_response.get(tag_id, 'no_tag') != 'no_tag' # For the possibility of a no_tag error
            tag_id = tag_response['tag_id']
        ELSE:
            raise ERROR "Error: TagID not present.", 400
    EXCEPT:
        raise ERROR "Status Code 500"
    
    # Next check if Author(s) is already present if not create records
    author_1_response = is_author_in_author_table(author_first_name_1, author_last_name_1) -> JSON
    print(author_1_response) # Should return for example: {"is_author_present": "True", 
                             #                             "AuthorID": "23"}
    
    # We do author_1 first since there is always atleast one author
    IF author_1_response["is_author_present"] == "True":
        # Here we use existing author_id and add a new record to the BookAuthor brigding table
        author_id_1 = author_1_response["AuthorID"] # Doesn't need to be assigned but used for clarity here
        create_book_author_table_record(isbn, author_id_1) -> status code (will be checked globally if error)
    ELSE:
        # Otherwise we first create a new author_id
        author_id_1 = create_author(author_first_name_1, author_last_name_1) -> JSON(AuthorID)
        print(author_id_1) # Should return for example: {"AuthorID": "24"}
        create_book_author_table_record(isbn, author_id_1) -> status code (will be checked globally if error)
        
    # Then we do author_2 if present
    IF author_first_name_2 != '':                    
        author_2_response = is_author_in_author_table(author_first_name_2, author_last_name_2) -> JSON
        print(author_2_response) # Should return for example: {"is_author_present": "False"}
        
        IF author_2_response["is_author_present"] == "True":
            # Here we use existing author_id and add a new record to the BookAuthor brigding table
            author_id_2 = author_2_response["AuthorID"] # Doesn't need to be assigned but used for clarity here
            create_book_author_table_record(isbn, author_id_2) -> status code (will be checked globally if error)
        ELSE:
            # Otherwise we first create a new author_id
            author_id_2 = create_author(author_first_name_2, author_last_name_2) -> JSON(AuthorID)
            print(author_id_2) # Should return for example: {"AuthorID": "24"}
            create_book_author_table_record(isbn, author_id_2) -> status code (will be checked globally if error)
    
    # Next we read or create publisher_id from publisher_name
    is_publisher_present = is_publisher_in_publisher_table(publisher_name) -> JSON
    print(is_publisher_present) # Should return for example: {"is_publisher_present": "False"}
    TRY:
        IF is_publisher_present['is_publisher_present'] != "False":
            publisher_id = create_publisher(publisher_name) -> JSON
            print(publisher_id)
        ELSE:
                
    EXCEPT:
        raise ERROR "Status Code 500"
    
















````


























